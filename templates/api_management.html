<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API YÃ¶netimi - AI Chrome Chat Manager</title>
    <meta name="theme-color" content="#ffffff">
    
    <!-- Design System -->
    <link rel="stylesheet" href="/static/css/design-system.css">
    
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        body {
            background: var(--bg-secondary);
            font-family: var(--font-family-base);
            min-height: 100vh;
        }
        
        .navbar-modern {
            background: var(--bg-surface);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-primary);
            padding: var(--space-4) 0;
            position: sticky;
            top: 0;
            z-index: var(--z-sticky);
            transition: all var(--transition-base);
        }

        .navbar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 var(--space-6);
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--text-primary);
            text-decoration: none;
        }

        .navbar-brand:hover {
            color: var(--primary-600);
        }

        .brand-icon {
            width: 32px;
            height: 32px;
            background: var(--gradient-primary);
            border-radius: var(--radius-base);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .navbar-nav {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            text-decoration: none;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            transition: all var(--transition-fast);
        }

        .nav-link:hover {
            color: var(--primary-600);
            background: var(--bg-tertiary);
        }

        .nav-link.active {
            color: var(--primary-600);
            background: rgba(59, 130, 246, 0.1);
        }
        
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-8) var(--space-6);
        }
        
        .page-header {
            text-align: center;
            margin-bottom: var(--space-10);
        }

        .page-title {
            font-size: var(--font-size-4xl);
            font-weight: var(--font-weight-bold);
            color: var(--text-primary);
            margin-bottom: var(--space-3);
        }

        .page-subtitle {
            font-size: var(--font-size-lg);
            color: var(--text-secondary);
        }
        
        .api-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: var(--space-8);
            margin-bottom: var(--space-10);
        }
        
        .api-provider-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-base);
        }

        .api-provider-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
            border-color: var(--border-secondary);
        }
        
        .api-card-header {
            background: var(--gradient-primary);
            color: white;
            padding: var(--space-6);
            position: relative;
            overflow: hidden;
        }

        .api-card-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .api-provider-info {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            position: relative;
            z-index: 1;
        }
        
        .provider-icon {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-2xl);
            color: white;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .provider-details h3 {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            margin: 0 0 var(--space-1) 0;
        }
        
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-1);
            font-size: var(--font-size-xs);
            padding: var(--space-1) var(--space-3);
            border-radius: var(--radius-full);
            font-weight: var(--font-weight-semibold);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status-active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-600);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .status-inactive {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger-600);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
        }
        
        .api-card-body {
            padding: var(--space-8);
        }
        
        .gemini-keys-container {
            margin-bottom: var(--space-6);
        }

        .key-form-section {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            margin-bottom: var(--space-4);
        }

        .key-form-header {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            margin-bottom: var(--space-4);
        }

        .key-badge {
            background: var(--gradient-primary);
            color: white;
            padding: var(--space-1) var(--space-3);
            border-radius: var(--radius-md);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-semibold);
            text-transform: uppercase;
        }

        .key-description {
            font-size: var(--font-size-sm);
            color: var(--text-muted);
        }
        
        .input-group-modern {
            margin-bottom: var(--space-4);
        }
        
        .input-modern {
            width: 100%;
            padding: var(--space-4);
            border: 2px solid var(--border-primary);
            border-radius: var(--radius-lg);
            background: var(--bg-surface);
            color: var(--text-primary);
            font-size: var(--font-size-base);
            font-family: var(--font-family-mono);
            transition: all var(--transition-fast);
        }
        
        .input-modern:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            background: var(--bg-surface);
        }

        .input-modern::placeholder {
            color: var(--text-muted);
            font-family: var(--font-family-base);
        }
        
        .btn-actions {
            display: flex;
            gap: var(--space-3);
            flex-wrap: wrap;
        }
        
        .test-result {
            margin-top: var(--space-4);
            padding: var(--space-4);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .test-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-700);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .test-error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger-700);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .api-help-link {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            font-size: var(--font-size-sm);
            color: var(--text-muted);
            margin-top: var(--space-4);
        }

        .api-help-link a {
            color: var(--primary-600);
            text-decoration: none;
            font-weight: var(--font-weight-medium);
        }

        .api-help-link a:hover {
            color: var(--primary-700);
            text-decoration: underline;
        }
        
        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-6);
            margin-bottom: var(--space-10);
        }
        
        .quick-action-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-base);
        }

        .quick-action-card:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--border-secondary);
        }
        
        .quick-action-header {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-4);
        }
        
        .quick-action-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }

        .quick-action-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            text-decoration: none;
            transition: all var(--transition-fast);
            cursor: pointer;
        }
        
        .quick-action-item:hover {
            background: var(--bg-tertiary);
            color: var(--primary-600);
            transform: translateX(4px);
        }

        .info-text {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
            line-height: var(--line-height-relaxed);
        }

        .info-text strong {
            color: var(--text-primary);
            font-weight: var(--font-weight-semibold);
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-2) 0;
            font-size: var(--font-size-sm);
        }

        .status-label {
            color: var(--text-secondary);
        }

        .role-assignment-section {
            background: var(--bg-surface);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }

        .role-assignment-header {
            background: var(--gradient-secondary);
            color: var(--text-primary);
            padding: var(--space-6);
        }

        .role-assignment-body {
            padding: var(--space-8);
        }

        .roles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-6);
        }

        .role-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            transition: all var(--transition-base);
        }

        .role-card:hover {
            background: var(--bg-surface);
            box-shadow: var(--shadow-sm);
            border-color: var(--border-secondary);
        }

        .role-header {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            margin-bottom: var(--space-4);
        }

        .role-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xl);
            color: white;
        }

        .role-icon.pm {
            background: var(--gradient-pm);
        }

        .role-icon.ld {
            background: var(--gradient-dev);
        }

        .role-icon.boss {
            background: var(--gradient-marketing);
        }

        .role-details h6 {
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin: 0 0 var(--space-1) 0;
        }

        .role-description {
            font-size: var(--font-size-sm);
            color: var(--text-muted);
        }

        .role-select {
            width: 100%;
            padding: var(--space-3);
            border: 2px solid var(--border-primary);
            border-radius: var(--radius-md);
            background: var(--bg-surface);
            color: var(--text-primary);
            font-size: var(--font-size-sm);
            margin-bottom: var(--space-3);
        }

        .role-select:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .current-assignment {
            padding: var(--space-3);
            background: rgba(59, 130, 246, 0.1);
            border-radius: var(--radius-md);
            border-left: 3px solid var(--primary-500);
        }

        .current-assignment .assignment-label {
            font-size: var(--font-size-xs);
            color: var(--text-muted);
            margin-bottom: var(--space-1);
        }

        .current-assignment .assignment-value {
            font-size: var(--font-size-sm);
            color: var(--primary-700);
            font-weight: var(--font-weight-medium);
        }

        @media (max-width: 768px) {
            .navbar-content {
                padding: 0 var(--space-4);
            }
            
            .main-container {
                padding: var(--space-6) var(--space-4);
            }
            
            .api-cards-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-actions-grid {
                grid-template-columns: 1fr;
            }
            
            .roles-grid {
                grid-template-columns: 1fr;
            }
            
            .btn-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar-modern">
        <div class="navbar-content">
            <a href="/" class="navbar-brand">
                <div class="brand-icon">
                    <i class="bi bi-robot"></i>
                </div>
                <span>AI Chrome Chat Manager</span>
            </a>
            <div class="navbar-nav">
                <a href="/" class="nav-link">
                    <i class="bi bi-house"></i>
                    <span>Ana Sayfa</span>
                </a>
                <a href="/api-management" class="nav-link active">
                    <i class="bi bi-key"></i>
                    <span>API YÃ¶netimi</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Page Header -->
        <div class="page-header" data-animate="fadeInUp">
            <h1 class="page-title">ð API Anahtar YÃ¶netimi</h1>
            <p class="page-subtitle">AI modelleri iÃ§in API anahtarlarÄ±nÄ±zÄ± gÃ¼venli bir Åekilde yÃ¶netin</p>
        </div>

        <!-- API Provider Cards -->
        <div class="api-cards-grid">
            <!-- Google Gemini -->
            <div class="api-provider-card" data-animate="fadeInLeft">
                <div class="api-card-header">
                    <div class="api-provider-info">
                        <div class="provider-icon">
                            <i class="bi bi-google"></i>
                        </div>
                        <div class="provider-details">
                            <h3>Google Gemini</h3>
                            <div class="status-badge status-inactive" id="gemini-status">
                                <div class="status-dot"></div>
                                <span>YapÄ±landÄ±rÄ±lmadÄ±</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="api-card-body">
                    <div id="gemini-keys-container" class="gemini-keys-container">
                        <!-- Primary Gemini key form -->
                        <div class="key-form-section gemini-key-form" data-key-name="primary">
                            <div class="key-form-header">
                                <span class="key-badge">Primary</span>
                                <span class="key-description">Ana Gemini API anahtarÄ±</span>
                            </div>
                            <div class="input-group-modern">
                                <input type="password" 
                                       class="input-modern gemini-key-input" 
                                       id="gemini-primary-key" 
                                       placeholder="Gemini API anahtarÄ±nÄ±zÄ± girin..."
                                       autocomplete="off">
                            </div>
                            <div class="btn-actions">
                                <button type="button" class="btn-modern btn-primary" onclick="testGeminiAPI('primary')">
                                    <i class="bi bi-lightning"></i>
                                    <span>Test Et</span>
                                </button>
                                <button type="button" class="btn-modern btn-success" onclick="saveGeminiAPI('primary')">
                                    <i class="bi bi-check-circle"></i>
                                    <span>Kaydet</span>
                                </button>
                                <button type="button" class="btn-modern btn-danger" onclick="deleteGeminiAPI('primary')">
                                    <i class="bi bi-trash"></i>
                                    <span>Sil</span>
                                </button>
                            </div>
                            <div class="test-result" id="gemini-primary-result"></div>
                        </div>
                    </div>
                    
                    <div class="api-help-link">
                        <i class="bi bi-info-circle"></i>
                        <span>API anahtarÄ± almak iÃ§in: 
                            <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a>
                        </span>
                    </div>
                </div>
            </div>

            <!-- OpenAI -->
            <div class="api-provider-card" data-animate="fadeInRight">
                <div class="api-card-header">
                    <div class="api-provider-info">
                        <div class="provider-icon">
                            <i class="bi bi-robot"></i>
                        </div>
                        <div class="provider-details">
                            <h3>OpenAI GPT</h3>
                            <div class="status-badge status-inactive" id="openai-status">
                                <div class="status-dot"></div>
                                <span>YapÄ±landÄ±rÄ±lmadÄ±</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="api-card-body">
                    <form id="openai-form">
                        <div class="input-group-modern">
                            <input type="password" 
                                   class="input-modern" 
                                   id="openai-key" 
                                   placeholder="OpenAI API anahtarÄ±nÄ±zÄ± girin..."
                                   autocomplete="off">
                        </div>
                        <div class="btn-actions">
                            <button type="button" class="btn-modern btn-primary" onclick="testAPI('openai')">
                                <i class="bi bi-lightning"></i>
                                <span>Test Et</span>
                            </button>
                            <button type="button" class="btn-modern btn-success" onclick="saveAPI('openai')">
                                <i class="bi bi-check-circle"></i>
                                <span>Kaydet</span>
                            </button>
                            <button type="button" class="btn-modern btn-danger" onclick="deleteAPI('openai')">
                                <i class="bi bi-trash"></i>
                                <span>Sil</span>
                            </button>
                        </div>
                        <div class="test-result" id="openai-result"></div>
                    </form>
                    
                    <div class="api-help-link">
                        <i class="bi bi-info-circle"></i>
                        <span>API anahtarÄ± almak iÃ§in: 
                            <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI Platform</a>
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions Grid -->
        <div class="quick-actions-grid">
            <!-- Quick Operations -->
            <div class="quick-action-card" data-animate="fadeInUp" data-delay="100">
                <div class="quick-action-header">
                    <i class="bi bi-lightning-charge"></i>
                    <span>HÄ±zlÄ± Ä°Ålemler</span>
                </div>
                <div class="quick-action-list">
                    <div class="quick-action-item" onclick="loadExistingKeys()">
                        <i class="bi bi-arrow-clockwise"></i>
                        <span>Mevcut AnahtarlarÄ± YÃ¼kle</span>
                    </div>
                    <div class="quick-action-item" onclick="clearAllKeys()">
                        <i class="bi bi-trash"></i>
                        <span>TÃ¼m AnahtarlarÄ± Temizle</span>
                    </div>
                </div>
            </div>
            
            <!-- Information -->
            <div class="quick-action-card" data-animate="fadeInUp" data-delay="200">
                <div class="quick-action-header">
                    <i class="bi bi-info-circle"></i>
                    <span>Bilgilendirme</span>
                </div>
                <div class="info-text">
                    <p><strong>GÃ¼venlik:</strong> API anahtarlarÄ±nÄ±z ÅifrelenmiÅ olarak saklanÄ±r.</p>
                    <p><strong>Test:</strong> AnahtarlarÄ± kaydetmeden Ã¶nce test edebilirsiniz.</p>
                    <p><strong>KullanÄ±m:</strong> En az bir API anahtarÄ± gereklidir.</p>
                </div>
            </div>

            <!-- System Status -->
            <div class="quick-action-card" data-animate="fadeInUp" data-delay="300">
                <div class="quick-action-header">
                    <i class="bi bi-gear"></i>
                    <span>Sistem Durumu</span>
                </div>
                <div id="system-status">
                    <div class="status-item">
                        <span class="status-label">Gemini:</span>
                        <span class="status-badge status-inactive" id="status-gemini">
                            <div class="status-dot"></div>
                            <span>KapalÄ±</span>
                        </span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">OpenAI:</span>
                        <span class="status-badge status-inactive" id="status-openai">
                            <div class="status-dot"></div>
                            <span>KapalÄ±</span>
                        </span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Sistem:</span>
                        <span class="status-badge status-active">
                            <div class="status-dot"></div>
                            <span>ÃalÄ±ÅÄ±yor</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Role Assignment Section -->
        <div class="role-assignment-section" data-animate="fadeInUp" data-delay="400">
            <div class="role-assignment-header">
                <div class="quick-action-header">
                    <i class="bi bi-people"></i>
                    <span>Rol AtamalarÄ±</span>
                </div>
                <p style="margin: var(--space-2) 0 0 0; opacity: 0.8;">AI asistanlarÄ±na roller atayÄ±n</p>
            </div>
            <div class="role-assignment-body">
                <div class="roles-grid">
                    <!-- Project Manager -->
                    <div class="role-card">
                        <div class="role-header">
                            <div class="role-icon pm">
                                <i class="bi bi-clipboard-check"></i>
                            </div>
                            <div class="role-details">
                                <h6>Project Manager</h6>
                                <p class="role-description">Proje yÃ¶netimi ve planlama</p>
                            </div>
                        </div>
                        <select class="role-select" id="role-project-manager" onchange="assignRole('project_manager', this.value)">
                            <option value="">SeÃ§iniz...</option>
                        </select>
                        <div class="current-assignment">
                            <div class="assignment-label">Mevcut Atama:</div>
                            <div class="assignment-value" id="current-project-manager">AtanmamÄ±Å</div>
                        </div>
                    </div>

                    <!-- Lead Developer -->
                    <div class="role-card">
                        <div class="role-header">
                            <div class="role-icon ld">
                                <i class="bi bi-code-slash"></i>
                            </div>
                            <div class="role-details">
                                <h6>Lead Developer</h6>
                                <p class="role-description">Teknik geliÅtirme ve kod incelemesi</p>
                            </div>
                        </div>
                        <select class="role-select" id="role-lead-developer" onchange="assignRole('lead_developer', this.value)">
                            <option value="">SeÃ§iniz...</option>
                        </select>
                        <div class="current-assignment">
                            <div class="assignment-label">Mevcut Atama:</div>
                            <div class="assignment-value" id="current-lead-developer">AtanmamÄ±Å</div>
                        </div>
                    </div>

                    <!-- Boss -->
                    <div class="role-card">
                        <div class="role-header">
                            <div class="role-icon boss">
                                <i class="bi bi-crown"></i>
                            </div>
                            <div class="role-details">
                                <h6>Boss</h6>
                                <p class="role-description">Stratejik kararlar ve yÃ¶nlendirme</p>
                            </div>
                        </div>
                        <select class="role-select" id="role-boss" onchange="assignRole('boss', this.value)">
                            <option value="">SeÃ§iniz...</option>
                        </select>
                        <div class="current-assignment">
                            <div class="assignment-label">Mevcut Atama:</div>
                            <div class="assignment-value" id="current-boss">AtanmamÄ±Å</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Include Theme Manager and Animation Utils -->
    <script src="/static/js/theme-manager.js"></script>
    <script src="/static/js/animation-utils.js"></script>

    <script>
        // API Management JavaScript
        function testGeminiAPI(keyName) {
            const input = document.getElementById(`gemini-${keyName}-key`);
            const resultDiv = document.getElementById(`gemini-${keyName}-result`);
            const apiKey = input.value.trim();

            if (!apiKey) {
                showResult(resultDiv, 'LÃ¼tfen API anahtarÄ±nÄ± girin.', 'error');
                return;
            }

            showResult(resultDiv, 'Test ediliyor...', 'info');

            // Test API call
            fetch('/api/test-key', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    provider: 'gemini',
                    key: apiKey,
                    keyName: keyName
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showResult(resultDiv, `â Test baÅarÄ±lÄ±! Model: ${data.model}`, 'success');
                    updateStatus('gemini', 'active');
                } else {
                    showResult(resultDiv, `â Test baÅarÄ±sÄ±z: ${data.error}`, 'error');
                }
            })
            .catch(error => {
                showResult(resultDiv, `â BaÄlantÄ± hatasÄ±: ${error.message}`, 'error');
            });
        }

        function saveGeminiAPI(keyName) {
            const input = document.getElementById(`gemini-${keyName}-key`);
            const resultDiv = document.getElementById(`gemini-${keyName}-result`);
            const apiKey = input.value.trim();

            if (!apiKey) {
                showResult(resultDiv, 'LÃ¼tfen API anahtarÄ±nÄ± girin.', 'error');
                return;
            }

            fetch('/api/save-key', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    provider: 'gemini',
                    key: apiKey,
                    keyName: keyName
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showResult(resultDiv, 'â API anahtarÄ± kaydedildi!', 'success');
                    updateStatus('gemini', 'active');
                } else {
                    showResult(resultDiv, `â Kaydetme baÅarÄ±sÄ±z: ${data.error}`, 'error');
                }
            })
            .catch(error => {
                showResult(resultDiv, `â Kaydetme hatasÄ±: ${error.message}`, 'error');
            });
        }

        function deleteGeminiAPI(keyName) {
            if (!confirm('Bu API anahtarÄ±nÄ± silmek istediÄinizden emin misiniz?')) {
                return;
            }

            const resultDiv = document.getElementById(`gemini-${keyName}-result`);

            fetch('/api/delete-key', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    provider: 'gemini',
                    keyName: keyName
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showResult(resultDiv, 'â API anahtarÄ± silindi!', 'success');
                    document.getElementById(`gemini-${keyName}-key`).value = '';
                    updateStatus('gemini', 'inactive');
                } else {
                    showResult(resultDiv, `â Silme baÅarÄ±sÄ±z: ${data.error}`, 'error');
                }
            })
            .catch(error => {
                showResult(resultDiv, `â Silme hatasÄ±: ${error.message}`, 'error');
            });
        }

        function testAPI(provider) {
            const input = document.getElementById(`${provider}-key`);
            const resultDiv = document.getElementById(`${provider}-result`);
            const apiKey = input.value.trim();

            if (!apiKey) {
                showResult(resultDiv, 'LÃ¼tfen API anahtarÄ±nÄ± girin.', 'error');
                return;
            }

            showResult(resultDiv, 'Test ediliyor...', 'info');

            fetch('/api/test-key', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    provider: provider,
                    key: apiKey
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showResult(resultDiv, `â Test baÅarÄ±lÄ±! Model: ${data.model}`, 'success');
                    updateStatus(provider, 'active');
                } else {
                    showResult(resultDiv, `â Test baÅarÄ±sÄ±z: ${data.error}`, 'error');
                }
            })
            .catch(error => {
                showResult(resultDiv, `â BaÄlantÄ± hatasÄ±: ${error.message}`, 'error');
            });
        }

        function saveAPI(provider) {
            const input = document.getElementById(`${provider}-key`);
            const resultDiv = document.getElementById(`${provider}-result`);
            const apiKey = input.value.trim();

            if (!apiKey) {
                showResult(resultDiv, 'LÃ¼tfen API anahtarÄ±nÄ± girin.', 'error');
                return;
            }

            fetch('/api/save-key', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    provider: provider,
                    key: apiKey
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showResult(resultDiv, 'â API anahtarÄ± kaydedildi!', 'success');
                    updateStatus(provider, 'active');
                } else {
                    showResult(resultDiv, `â Kaydetme baÅarÄ±sÄ±z: ${data.error}`, 'error');
                }
            })
            .catch(error => {
                showResult(resultDiv, `â Kaydetme hatasÄ±: ${error.message}`, 'error');
            });
        }

        function deleteAPI(provider) {
            if (!confirm('Bu API anahtarÄ±nÄ± silmek istediÄinizden emin misiniz?')) {
                return;
            }

            const resultDiv = document.getElementById(`${provider}-result`);

            fetch('/api/delete-key', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    provider: provider
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showResult(resultDiv, 'â API anahtarÄ± silindi!', 'success');
                    document.getElementById(`${provider}-key`).value = '';
                    updateStatus(provider, 'inactive');
                } else {
                    showResult(resultDiv, `â Silme baÅarÄ±sÄ±z: ${data.error}`, 'error');
                }
            })
            .catch(error => {
                showResult(resultDiv, `â Silme hatasÄ±: ${error.message}`, 'error');
            });
        }

        function showResult(element, message, type) {
            element.textContent = message;
            element.className = `test-result test-${type}`;
            element.style.display = 'block';

            setTimeout(() => {
                element.style.display = 'none';
            }, 5000);
        }

        function updateStatus(provider, status) {
            const statusElement = document.getElementById(`${provider}-status`);
            const systemStatusElement = document.getElementById(`status-${provider}`);
            
            if (status === 'active') {
                statusElement.className = 'status-badge status-active';
                statusElement.innerHTML = '<div class="status-dot"></div><span>Aktif</span>';
                if (systemStatusElement) {
                    systemStatusElement.className = 'status-badge status-active';
                    systemStatusElement.innerHTML = '<div class="status-dot"></div><span>Aktif</span>';
                }
            } else {
                statusElement.className = 'status-badge status-inactive';
                statusElement.innerHTML = '<div class="status-dot"></div><span>YapÄ±landÄ±rÄ±lmadÄ±</span>';
                if (systemStatusElement) {
                    systemStatusElement.className = 'status-badge status-inactive';
                    systemStatusElement.innerHTML = '<div class="status-dot"></div><span>KapalÄ±</span>';
                }
            }
        }

        function loadExistingKeys() {
            fetch('/api/load-keys')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Load keys into inputs
                    Object.keys(data.keys).forEach(provider => {
                        const input = document.getElementById(`${provider}-key`);
                        if (input && data.keys[provider]) {
                            input.value = 'â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢';
                            updateStatus(provider, 'active');
                        }
                    });
                    alert('Mevcut anahtarlar yÃ¼klendi!');
                } else {
                    alert('Anahtar yÃ¼kleme baÅarÄ±sÄ±z!');
                }
            })
            .catch(error => {
                alert('Anahtar yÃ¼kleme hatasÄ±!');
            });
        }

        function clearAllKeys() {
            if (!confirm('TÃ¼m API anahtarlarÄ±nÄ± silmek istediÄinizden emin misiniz?')) {
                return;
            }

            fetch('/api/clear-all-keys', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Clear all inputs
                    document.querySelectorAll('input[type="password"]').forEach(input => {
                        input.value = '';
                    });
                    
                    // Update all status
                    updateStatus('gemini', 'inactive');
                    updateStatus('openai', 'inactive');
                    
                    alert('TÃ¼m API anahtarlarÄ± temizlendi!');
                } else {
                    alert('Temizleme baÅarÄ±sÄ±z!');
                }
            })
            .catch(error => {
                alert('Temizleme hatasÄ±!');
            });
        }

        function assignRole(role, provider) {
            if (!provider) return;

            fetch('/api/assign-role', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    role: role,
                    provider: provider
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById(`current-${role.replace('_', '-')}`).textContent = provider;
                    alert(`${role} rolÃ¼ ${provider} provider'Ä±na atandÄ±!`);
                } else {
                    alert('Rol atama baÅarÄ±sÄ±z!');
                }
            })
            .catch(error => {
                alert('Rol atama hatasÄ±!');
            });
        }

        // Load initial data
        document.addEventListener('DOMContentLoaded', () => {
            loadExistingKeys();
            
            // Populate role selectors
            const providers = ['gemini', 'openai'];
            providers.forEach(provider => {
                ['role-project-manager', 'role-lead-developer', 'role-boss'].forEach(selectId => {
                    const select = document.getElementById(selectId);
                    if (select) {
                        const option = document.createElement('option');
                        option.value = provider;
                        option.textContent = provider.charAt(0).toUpperCase() + provider.slice(1);
                        select.appendChild(option);
                    }
                });
            });
        });
    </script>
</body>
</html> 
</html> 